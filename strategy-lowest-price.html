<script type="text/javascript">
  RED.nodes.registerType("ps-strategy-lowest-price", {
    category: "Power Saver",
    color: "#a6bbcf",
    defaults: {
      name: { value: "Lowest Price" },
      fromTime: {
        value: "12:00",
        required: true,
        validate: validateTimeOfDay(),
      },
      toTime: {
        value: "12:00",
        required: true,
        validate: validateTimeOfDay(),
      },
      timeOn: {
        value: "12:00",
        required: true,
        validate: validateTime(),
      },
      doNotSplit: {
        value: false,
        required: true,
        align: "left",
      },
    },
    inputs: 1,
    outputs: 3,
    icon: "font-awesome/fa-eur",
    color: "#FFCC66",
    label: function () {
      return this.name || "ps-strategy-lowest-price";
    },
    outputLabels: ["on", "off", "schedule"],
    validateTime: function () {
      return true;
    },
    validateTimeOfDay: function () {
      return true;
    },
  });
</script>

<script type="text/html" data-template-name="ps-strategy-lowest-price">
  <div class="form-row">
      <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
      <input type="text" id="node-input-name" placeholder="Name" style="width: 240px">
  </div>

  <div class="form-row">
      <label for="node-input-fromTime"><i class="fa fa-arrows-h"></i> Max per sequence</label>
      <input type="text" id="node-input-fromTime" style="width: 80px" placeholder="From time (HH:MM)">
  </div>
  <div class="form-row">
      <label for="node-input-toTime"><i class="fa fa-arrows-h"></i> Max per sequence</label>
      <input type="text" id="node-input-toTime" style="width: 80px" placeholder="Tom til (HH:MM)">
  </div>
  <div class="form-row">
      <label for="node-input-timeOn"><i class="fa fa-arrows-h"></i> Max per sequence</label>
      <input type="text" id="node-input-timeOn" style="width: 80px" placeholder="Time on (HH:MM)">
  </div>
  <div class="form-row">
      <label for="node-input-doNotSplit">Consecutive on-period</label>
      <input type="boolean" id="node-input-doNotSplit" style="width: 80px">
      </label>
  </div>
</script>

<script type="text/markdown" data-help-name="ps-strategy-lowest-price">
  A node to turn on a switch the hours when the price is lowest.

  Configure the number of hours to be on in total,
  and whether it shall be one consecutive period,
  or it can be split in different periods.

  You may also limit the time on to be within a certain period of the day.
  If you want to specify multiple periods, use multiple nodes.
</script>
